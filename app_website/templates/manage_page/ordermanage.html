<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
      <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	
	
	<title>李清装饰-后台管理系统</title>
	
	<!--                       CSS                       -->
	
	<!-- Reset Stylesheet -->
	<link rel="stylesheet" href="{{ STATIC_URL }}simpla/reset.css" type="text/css" media="screen" />
	
	<!-- Main Stylesheet -->
	<link rel="stylesheet" href="{{ STATIC_URL }}simpla/style.css" type="text/css" media="screen" />
	
	<!-- Invalid Stylesheet. This makes stuff look pretty. Remove it if you want the CSS completely valid -->
	<link rel="stylesheet" href="{{ STATIC_URL }}simpla/invalid.css" type="text/css" media="screen" />
    
        <!-- Self Stylesheet -->
        <link rel="stylesheet" href="{{ STATIC_URL }}simpla/self.css" type="text/css" media="screen" />	
        
	<!-- jQuery -->
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/jquery-1.3.2.min.js"></script>
	
	<!-- jQuery Configuration -->
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/simpla.jquery.configuration.js"></script>
	
	<!-- Facebox jQuery Plugin -->
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/facebox.js"></script>
	
	<!-- jQuery fix clone() Plugin -->
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/jquery.fix.clone.js"></script>
	
	<!-- jQuery WYSIWYG Plugin -->
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/jquery.wysiwyg.js"></script>
	
	<!-- jQuery Datepicker Plugin -->
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/jquery.datePicker.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}simpla/jquery.date.js"></script>
	<!--[if IE]><script type="text/javascript" src="{{ STATIC_URL }}simpla/jquery.bgiframe.js"></script><![endif]-->

	
	<!-- Internet Explorer .png-fix -->
	
	<!--[if IE 6]>
	    <script type="text/javascript" src="{{ STATIC_URL }}simpla/DD_belatedPNG_0.0.7a.js"></script>
	    <script type="text/javascript">
	      DD_belatedPNG.fix('.png_bg, img, li');
	    </script>
	    <![endif]-->
	
      </head>
      
      <body>
	<div id="body-wrapper"> <!-- Wrapper for the radial gradient background -->
	  
	  <div id="sidebar"><div id="sidebar-wrapper"> <!-- Sidebar with logo and menu -->
	      
	      <h1 id="sidebar-title"><a href="#"></a></h1>
	      
	      <!-- Logo (221px wide) -->
	      <a href="#"><img id="logo" src="{{ STATIC_URL }}simpla/images/logo.png" alt="Simpla Admin logo" /></a>
	      <!-- Sidebar Profile links -->
	      <ul id="main-nav">  <!-- Accordion Menu -->	
		<li>
		  <a href="/gerryhost/index/"><!-- Add the class "no-submenu" to menu items with no sub menu -->
		    <div class="nav-top-item">
		      主页
		    </div>
		  </a>       
		</li>
		<li>
		  <a href="/gerryhost/ordermanage">
		    <div class="nav-top-item">
		      订单管理
		    </div>
		  </a>
		  <ul>
		    <li><a href="#">Write a new Article</a></li>
		    <li><a class="current" href="#">Manage Articles</a></li>
		    <li><a href="#">Manage Comments</a></li>
		    <li><a href="#">Manage Categories</a></li>
		  </ul>
		</li>
		<li> 
		  <a href="/gerryhost/usermanage">
		    <div class="nav-top-item">
		      用户管理
		    </div>
		  </a>
		</li>	
		<li>
		  <a href="#">
		    <div>
		    </div>
		  </a>
		</li>
		<li>
		  <a href="#">
		    <div>
		      
		    </div>
		  </a>
		</li>
		<li>
		  <a href="#">
		    <div>
		      
		    </div>
		  </a>
		</li>
		<li>
		  <a href="#">
		    <div>
		      
		    </div>
		  </a>
		</li>
		<li>
		  <input id="current" type="button" value="退出登录"/>
		</li>
	      </ul> <!-- End #main-nav -->
	      <script type="text/javascript">
		$(document).ready(function(){
		$("#current").click(function(){
		$.ajax({
		type:"POST",
		url:"/logout/",
		data:{
		'logout':"quit",
		},
		success: function(response){
                document.location.assign('/login/');
		}
		});
		});
		});
	      </script>			
	  </div></div> <!-- End #sidebar -->		
	  <div id="main-content"> <!-- Main Content Section with everything -->			
	    <noscript> <!-- Show a notification if the user has disabled javascript -->
	      <div class="notification error png_bg">
		<div>
		  Javascript is disabled or is not supported by your browser. Please <a href="http://browsehappy.com/" title="Upgrade to a better browser">upgrade</a> your browser or <a href="http://www.google.com/support/bin/answer.py?answer=23852" title="Enable Javascript in your browser">enable</a> Javascript to navigate the interface properly.
		  Download From <a href="http://www.exet.tk">exet.tk</a></div>
	      </div>
	    </noscript>			
	    <!-- Page Head -->
	    {%block pagehead%}
	    <h2>订单管理</h2>
	    <p id="page-intro"></p>			
	    <ul class="shortcut-buttons-set">				
	      <li><a class="shortcut-button" href="#"><span>
		    <img src="{{ STATIC_URL }}simpla/images/icons/pencil_48.png" alt="icon" /><br />
		    今日订单
	      </span></a></li>				
	      <li><a class="shortcut-button" href="#"><span>
		    <img src="{{ STATIC_URL }}simpla/images/icons/paper_content_pencil_48.png" alt="icon" /><br />
		    查询全部订单
	      </span></a></li>				
	      <li><a class="shortcut-button" href="#"><span>
		    <img src="{{ STATIC_URL }}simpla/images/icons/image_add_48.png" alt="icon" /><br />
		    按条件查询
	      </span></a></li>
	    </ul><!-- End .shortcut-buttons-set -->
	    {%endblock%}			
	    <div class="clear"></div> <!-- End .clear -->			
	    <div class="content-box"><!-- Start Content Box -->
	      {%block table_tittle%}				
	      <div class="content-box-header">					
		<h3>订单信息</h3>					
		<ul class="content-box-tabs">
		  <li><a href="#tab1" class="default-tab">订单列表</a></li> <!-- href must be unique and match the id of target div -->
		  <!-- <li><a href="#tab2">订单详情</a></li> -->
		</ul>					
		<div class="clear"></div>					
	      </div> <!-- End .content-box-header -->	
	      {%endblock%}			
	      <div class="content-box-content">					
		<div class="tab-content default-tab" id="tab1"> <!-- This is the target div. id must match the href of this div's tab -->						
		  <div class="notification attention png_bg">
		    <a href="#" class="close"><img src="{{ STATIC_URL }}simpla/images/icons/cross_grey_small.png" title="Close this notification" alt="close" /></a>
		    <div>
		      在此页面的操作将改变数据库的存储信息,请谨慎操作!!!
		    </div>
		  </div>						
		  <table>							
		    <thead>
		      <tr>
			<th><input class="check-all" type="checkbox" id="checkall"/></th>
			{%block tr_tittle%}
			<th>日期</th>
			<th>订单编号</th>
			<th>OpenId</th>
			<th>微信号</th>
			<th>已点菜品</th>
			<th>订单总额</th>
			<th>会员折扣</th>
			<th>应收金额</th>
			<th>订单状态</th>
			<th>客户姓名</th>
			<th>客户电话</th>
			<th>详细地址</th>		   
			{%endblock%}
		      </tr>								
		    </thead>						 
		    <tfoot>
		      <tr>
			<td colspan="6">
			  <div class="bulk-actions align-left">
			    <a class="button" href="#newmessages" rel="modal" title="add" id="add">增加</a>
                            <div id="newmessages" style="display: none"> <!-- Messages are shown when a link with these attributes are clicked: href="#messages" rel="modal"  -->
                              {%block add_block%}
                              <p>订单不能手动添加，请从微信订餐！</p>
                              {%endblock%}
                              {% block add_form_check_block %}
                              {% endblock %}
                            </div>
			    <a class="button" href="#" id="delete_data">删除</a>
			    <a class="button" id="a_update" onclick="javascript:return before_update_modal();" rel="modal">修改</a>
                            <div id="no_checked" style="display: none">
                              <p>请选择一项数据！</p>
                            </div>
                            <div id="more_checked" style="display: none">
                              <p>只能选择一项数据！</p>
                            </div>
                            <div id="update_data" style="display: none">
                              {%block update_block%}
                              <form name="update_form" method="POST" onsubmit="return update_form_check()" action="/manage/">							
                                <h3>修改信息</h3>												 
                                <div id="left" style="float:left;display:inline;font-size:14px;">
                                  <h6 class="newmenu_label">日期：</h6><br/>
                                  <h6 class="newmenu_label">订单编号：</h6><br/>
                                  <h6 class="newmenu_label">OpenId：</h6><br/>
                                  <h6 class="newmenu_label">微信号：</h6><br/>
                                  <h6 class="newmenu_label">订单总额：</h6><br/>
                                  <h6 class="newmenu_label">会员折扣：</h6><br/>
                                  <h6 class="newmenu_label">应收金额：</h6><br/>
                                  <h6 class="newmenu_label">客户姓名：</h6><br/>
                                  <h6 class="newmenu_label">客户电话：</h6><br/>
                                  <h6 class="newmenu_label">详细地址：</h6><br/>
                                  <h6 class="newmenu_label">备注：</h6><br/>
                                  <h6 class="newmenu_label">订单状态：</h6><br/>
                                </div>
                                <div id="center" style="float:right;display:inline;width:80%;">
                                  <input id="update_datetime" type="text" class="newmenu_message" style="margin-top: 1px;" readonly="readonly"/>
                                  <input id="update_id" name="id" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_open_id" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_wechat_nickname" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_amount" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_discount" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_real_amount" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_stored_name" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_stored_tel" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_stored_address" type="text" class="newmenu_message" readonly="readonly"/>
                                  <input id="update_remarks_others" type="text" class="newmenu_message" readonly="readonly"/>
                                  <select id="update_state" name="state" class="newmenu_message" style="color: blue;">
                                    <option value="0">配送中</option>
                                    <option value="1">配送完成</option>
                                    <option value="2">取消</option>
                                  </select>
                                </div>
                                
                                <div id="right"> 							
                                  <input id="save" class="button" type="submit" style="float:center" value="保存" />
                                </div>
                              </form>
                              {%endblock%}
                              {% block update_form_check_block %}
                              <script>
                                function update_form_check(){
                                }
                              </script>
                              {% endblock %}
                            </div>
                          </div>
			</td>
			<td colspan="6">	
			  <div class="pagination">
                            {% ifnotequal curPage 1 %}
			    <a href="?curPage={{curPage}}&&totalPage={{totalPage}}&&jumpType=firstPage" title="First Page">&laquo; 首页</a>
                            {% endifnotequal %}
                            {% ifnotequal curPage 1 %}
                            <a href="?curPage={{curPage}}&&totalPage={{totalPage}}&&jumpType=pageUp" title="Previous Page">&laquo; 上一页</a>
                            {% endifnotequal %}
                            {% for page in pageRange %}
                            {% if page in displayPageRange %}
                            {% ifequal page curPage %}
                            <a onclick="return false;" class="number current" title={{page}}>{{page}}</a>
                            {% else %}
			    <a href="?curPage={{page}}&&totalPage={{totalPage}}&&jumpType=jumpPage" class="number" title={{page}}>{{page}}</a>
                            {% endifequal %}
                            {% else %}
                            {% ifequal page 1 %}
                            <a href="?curPage={{page}}&&totalPage={{totalPage}}&&jumpType=jumpPage" class="number" title={{page}}>{{page}}</a>
                            {% if not page in longerPageRange %}..
                            {% endif %}
                            {% else %}
                            {% ifequal page totalPage %}
                            {% if not page in longerPageRange %}..
                            {% endif %}
                            <a href="?curPage={{page}}&&totalPage={{totalPage}}&&jumpType=jumpPage" class="number" title={{page}}>{{page}}</a>
                            {% endifequal %}
                            {% endifequal %}
                            {% endif %}
                            {% endfor %}
                            {% ifnotequal curPage totalPage %}
			    <a href="?curPage={{curPage}}&&totalPage={{totalPage}}&&jumpType=pageDown" title="Next Page">下一页 &raquo;</a>
                            {% endifnotequal %}
                            {% ifnotequal curPage totalPage %}
                            <a href="?curPage={{curPage}}&&totalPage={{totalPage}}&&jumpType=lastPage" title="Last Page">尾页&raquo;</a>
                            {% endifnotequal %}
			  </div> <!-- End .pagination -->
			  <div class="clear"></div>
			</td>
                      </tr>
                    </tfoot>
		    <tbody valign="middle">
		      {%for element in data_list%}
		      <tr>	
			{%block tr_content%}
			<td><input type="checkbox" name="{{element.id}}" /></td>
			<td>{{element.datetime}}</td>
			<td>{{element.id}}</td>
			<td>{{element.info.member.open_id}}</td>
			<td>{{element.info.member.wechat_nickname}}</td>
			<td>
                          {% for order_menu in element.tbx_order_menu_set.all %}
                          {{order_menu.menu.name}}：{{order_menu.quantity}}份 * {{order_menu.menu.price}}元/份<br />
                          {% endfor %}
                        </td>
			<td>￥{{element.amount}}</td>
			<td>{{element.discount}}%</td>
			<td>￥{{element.real_amount}}</td>
			{%ifequal element.state "0"%}<td>配送中</td>
                        {%else%}
                        {%ifequal element.state "1"%}<td>配送完成</td>
                        {%else%}
                        {%ifequal element.state "2"%}<td>取消</td>
                        {%endifequal%}
                        {%endifequal%}
                        {%endifequal%}
			<td>{{element.info.stored_name}}</td>
			<td>{{element.info.stored_tel}}</td>
			<td>{{element.info.stored_address}}</td>
			{%endblock%}
		      </tr>
		      {%endfor%}
                      {%block script%}
                      <script>
                        $(document).ready(function(){
                        $('#delete_data').click(function(){
                        var el = document.getElementsByTagName('input'); 
                        var len = el.length; 
                        for(var i=0; i<len; i++) { 
                                            if((el[i].type=="checkbox") && el[i].checked == true) { 
                                            $.ajax({  
                                            type:'POST',              
                                            contentType: "application/x-www-form-urlencoded;charset=utf-8",  
                                            url:"/manage/",  
                                            data:{
                                            "delete":el[i].name,
                                            },  
                                            //成功后  
                                            success:function(){
                                            //location.reload();      
                                            },  
                                            complete:function(){  
                                            //$("[name = 'checkbox']").attr('checked',false);//取消选择  
                                            window.location.href = "/manage/"
                                            //location.reload(true);//刷新  会重复提交POST数据 
                                            }   
                                            });
                                            } 
                                            }
                                            
                                            }); 
                                            $('#delete_data').unblind('click')
                                            });
                                            </script>					
                      {%endblock%}
                      {% block get_checked_id_block %}
		      <script>
                        function get_checked_id(){
                        var el = document.getElementsByTagName('input'); 
			var len = el.length;
                        var checked_len = 0;
                        var checked_id = 0;
                        for(var i=0; i<len; i++) { 
                                            if((el[i].type=="checkbox") && el[i].checked == true) {
                                            checked_len++;
                                            if(checked_len > 1){return -1;}
                          checked_id = el[i].name;
                          }
                          }
                          if(checked_len == 0){return -2;}
                          return checked_id;
                          }
			</script>
                        {% endblock %}	
                        {% block before_update_modal_block %}
			<script>
                          function before_update_modal(){
                          var checked_id = get_checked_id();
                          if(checked_id == -1)
                          document.getElementById("a_update").href = "#more_checked";
                          else if(checked_id == -2)
                          document.getElementById("a_update").href = "#no_checked";
                          else{
                          document.getElementById("a_update").href = "#update_data";
                          {% for element in data_list %}
                          if({{element.id}} == checked_id){
                          document.getElementById("update_datetime").value = "{{element.datetime}}";
                          document.getElementById("update_id").value = "{{element.id}}";
                          document.getElementById("update_open_id").value = "{{element.info.member.open_id}}";
                          document.getElementById("update_wechat_nickname").value = "{{element.info.member.wechat_nickname}}";
                          document.getElementById("update_amount").value = "￥" + "{{element.amount}}";
                          document.getElementById("update_discount").value = "{{element.discount}}" + "%";
                          document.getElementById("update_real_amount").value = "￥" + "{{element.real_amount}}";
                          document.getElementById("update_stored_name").value = "{{element.info.stored_name}}";
                          document.getElementById("update_stored_tel").value = "{{element.info.stored_tel}}";
                          document.getElementById("update_stored_address").value = "{{element.info.stored_address}}";
                          document.getElementById("update_remarks_others").value = "{{element.remarks_others}}";
                          document.getElementById("update_state").value = "{{element.state}}";
                          }
                          {% endfor %}
                          }
                          }
			</script>
                        {% endblock %}								
		      </tbody>							
		    </table>						
		  </div> <!-- End #tab1 -->					
		</div> <!-- End .content-box-content -->				
	      </div> <!-- End .content-box -->			
	      <div class="clear"></div>
	      <!-- End Notifications -->
	      <div id="footer">
		<small> <!-- Remove this notice or replace it with whatever you want -->
		  &#169; 李清装饰工程有限公司版权所有 
		</small>
	      </div><!-- End #footer -->
	    </div> <!-- End #main-content -->
	  </div>
        </body>
        <!-- Download From www.exet.tk-->
      </html>
